((function(){this.Game=function(){function a(){var a;this.interval=1/60*1e3,this.input=new Input,a=this,this.step_callback=function(){return a.step()}}return a.prototype.start=function(){return this.step()},a.prototype.step=function(){return console.log("Implement me!!!")},a.prototype.next=function(){return window.setTimeout(this.step_callback,this.interval)},a}()})).call(this),function(){this.Input=function(){function a(){var a,b,c,d;this.keys={},d=this.keys,c=function(a){return a.which||(a.which=a.charCode),a.which||(a.which=a.keyCode),a},a=function(a){return d["key"+c(a).which]=!0},b=function(a){return d["key"+c(a).which]=!1},document.onkeydown=a,document.onkeyup=b,this.shortcuts={left:["key37","key65"],right:["key39","key68"],up:["key38","key87"],down:["key40","key83"]}}return a.prototype.left=function(a){return this.keys[this.shortcuts.left[a]]||!1},a.prototype.right=function(a){return this.keys[this.shortcuts.right[a]]||!1},a.prototype.up=function(a){return this.keys[this.shortcuts.up[a]]||!1},a.prototype.down=function(a){return this.keys[this.shortcuts.down[a]]||!1},a}()}.call(this),function(){this.World=function(){function a(a,b){var c,d;this.canvas=document.getElementById(a),this.ctx=this.canvas.getContext("2d"),this.width=parseFloat(this.canvas.width),this.height=parseFloat(this.canvas.height),c=this.height/this.width,this.box2dWidth=10,this.box2dHeight=10*c,this.ctx.scale(this.width/this.box2dWidth,this.height/this.box2dHeight),d=new Box2D.Common.Math.b2Vec2(0,14),this.world=new Box2D.Dynamics.b2World(d,!0),this.sprites=[],this.interval=b/1e3}return a.prototype.addSprite=function(a){var b;return b=this.world.CreateBody(a.body),b.CreateFixture(a.fixture),this.sprites.push({sprite:a,body:b})},a.prototype.draw=function(){var a,b,c,d,e;this.ctx.clearRect(0,0,this.box2dWidth,this.box2dHeight),this.ctx.fillStyle="#555",this.ctx.fillRect(0,this.box2dHeight-.5,this.width,.5),d=this.sprites,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],a.sprite.updateBody(a.body),e.push(a.sprite.draw(this.ctx));return e},a.prototype.step=function(){return this.world.Step(this.interval,10,10),this.world.ClearForces()},a}()}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};this.SlimeVolleyball=function(a){function c(){c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.start=function(){var a,b,d,e,f;this.world=new World("canvas",this.interval),this.p1=new Slime(2,4,"#0f0"),this.p2=new Slime(5,5,"#00f"),this.ball=new Ball(2,3,"#000"),this.p1.ball=this.ball,this.p2.ball=this.ball,this.p2.isP2=1,this.world.addSprite(this.p1),this.world.addSprite(this.p2),this.world.addSprite(this.ball),b=.2,d=[new Box(-b,0,b,this.world.box2dHeight),new Box(0,this.world.box2dHeight+b,this.world.box2dWidth,b),new Box(this.world.box2dWidth+b,0,b,this.world.box2dHeight),new Box(0,-b,this.world.box2dWidth,b)];for(e=0,f=d.length;e<f;e++)a=d[e],this.world.addSprite(a);return c.__super__.start.call(this)},c.prototype.step=function(){this.p1.handleInput(this.input),this.p2.handleInput(this.input),this.world.draw(),this.world.step();if(this.ball.y+this.ball.radius>this.world.box2dHeight-this.p1.radius)return;return this.next()},c}(Game),window.onload=function(){var a;return a=new SlimeVolleyball,a.start()}}.call(this),function(){this.Sprite=function(){function a(a,b,c,d){this.x=a,this.y=b,this.width=c,this.height=d,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.createBody()}return a.prototype.createBody=function(){return this.body=null},a.prototype.updateBody=function(a){if(a)return this.x=a.GetPosition().x,this.y=a.GetPosition().y,this.m_body=a},a.prototype.draw=function(a){return console.log("Override me!")},a}()}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};this.Slime=function(a){function c(a,b,d){this.x=a,this.y=b,this.color=d,this.radius=.5,this.isP2=0,c.__super__.constructor.call(this,this.x,this.y,this.radius*2,this.radius*2)}return b(c,a),c.prototype.createBody=function(){return this.fixture=new Box2D.Dynamics.b2FixtureDef,this.fixture.density=1,this.fixture.friction=1,this.fixture.restitution=0,this.fixture.shape=new Box2D.Collision.Shapes.b2CircleShape(this.radius),this.body=new Box2D.Dynamics.b2BodyDef,this.body.type=Box2D.Dynamics.b2Body.b2_dynamicBody,this.body.position.Set(this.x,this.y)},c.prototype.handleInput=function(a){a.left(this.isP2)&&(this.m_body.m_linearVelocity.x=-4,this.m_body.SetAwake(!0)),a.right(this.isP2)&&(this.m_body.m_linearVelocity.x=4,this.m_body.SetAwake(!0)),a.up(this.isP2)&&this.m_body.GetPosition().y>5.7&&(this.m_body.m_linearVelocity.y=-7,this.m_body.SetAwake(!0));if(a.down(this.isP2)){if(this.m_body.m_linearVelocity.y>0&&this.m_body.GetPosition().y<5)return this.m_body.m_linearVelocity.y*=1.5}else if(this.m_body&&this.m_body.GetPosition().y>5.5)return this.m_body.m_linearVelocity.x/=1.1},c.prototype.draw=function(a){var b,c;return a.fillStyle=this.color,a.beginPath(),a.arc(this.x,this.y,this.radius,0,Math.PI,!0),a.closePath(),a.fill(),this.isP2===0?c=new Box2D.Common.Math.b2Vec2(this.x+this.radius/2,this.y-this.radius/2):c=new Box2D.Common.Math.b2Vec2(this.x-this.radius/2,this.y-this.radius/2),a.fillStyle="#ffffff",a.beginPath(),a.arc(c.x,c.y,.1,0,Math.PI*2,!0),a.closePath(),a.fill(),b=new Box2D.Common.Math.b2Vec2(this.ball.x,this.ball.y),b.Subtract(c),b.Normalize(),b.Multiply(.05),b.Add(c),a.fillStyle="#000000",a.beginPath(),a.arc(b.x,b.y,.05,0,Math.PI*2,!0),a.closePath(),a.fill()},c}(Sprite)}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};this.Box=function(a){function c(a,b,d,e){this.x=a,this.y=b,this.width=d,this.height=e,this.color="#444",c.__super__.constructor.apply(this,arguments)}return b(c,a),c.prototype.createBody=function(){return this.fixture=new Box2D.Dynamics.b2FixtureDef,this.fixture.friction=1,this.fixture.restitution=0,this.fixture.shape=new Box2D.Collision.Shapes.b2PolygonShape,this.fixture.shape.SetAsBox(this.width,this.height),this.body=new Box2D.Dynamics.b2BodyDef,this.body.type=Box2D.Dynamics.b2Body.b2_staticBody,this.body.position.Set(this.x,this.y)},c.prototype.draw=function(a){},c}(Sprite)}.call(this),function(){var a=Object.prototype.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};this.Ball=function(a){function c(a,b,d){this.x=a,this.y=b,this.color=d,this.radius=.14,c.__super__.constructor.call(this,this.x,this.y,this.radius*2,this.radius*2)}return b(c,a),c.prototype.createBody=function(){return this.fixture=new Box2D.Dynamics.b2FixtureDef,this.fixture.density=.4,this.fixture.friction=.5,this.fixture.restitution=.2,this.fixture.shape=new Box2D.Collision.Shapes.b2CircleShape(this.radius),this.body=new Box2D.Dynamics.b2BodyDef,this.body.type=Box2D.Dynamics.b2Body.b2_dynamicBody,this.body.position.Set(this.x,this.y)},c.prototype.draw=function(a){return a.fillStyle=this.color,a.beginPath(),a.arc(this.x,this.y,this.radius,0,Math.PI*2,!0),a.closePath(),a.fill()},c}(Sprite)}.call(this)